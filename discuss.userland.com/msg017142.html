<html>	<head>		<title>Piking behind firewalls</title>		</head>	<body>		<blockquote><blockquote>			<b>Archive of UserLand's first discussion group, started October 5, 1998.</b><hr>			<h2>Piking behind firewalls</h2>			<table cellpadding="0" cellspacing="5">				<tr><td><b>Author:</b></td><td>Dave Winer</td></tr>				<tr><td><b>Posted:</b></td><td>5/9/2000; 9:59:34 PM</td></tr>				<tr><td><b>Topic:</b></td><td><a href="msg017142.html">Piking behind firewalls</a></td></tr>				<tr><td><b>Msg #:</b></td><td>17142</td></tr>				<tr><td><b>Prev/Next:</b></td><td><a href="msg017141.html">17141</a> / <a href="msg017143.html">17143</a></td></tr>				</table>			<br><b>Background</b><br><br>	While Brent has been working on the security issue I've been looking at how to work with the firewall issue in Pike, per Sam Yates' <a href="http://discuss.userland.com/msgReader$17099">suggestion</a>. If all goes well I'll have a test server running the software tomorrow or Thursday, and people can try it out. It doesn't appear to be too hard or effect too much code.<br><br>	BTW, I'm using a style we use on our internal website, this is a narrative document. It goes through a process, and is only finished when the [In Progress] part of the title goes away. In this case I hope to take it off when the feature is operational.<br><br><b>The Pike button</b><br><br>	When Manila generates the Pike button, the url comes from an object named editInPike in the #urls table for the site. That URL must change to point to the local server.<br><br>	The virtual file that's referenced is called "editInPike". So if Pike is running on port 81, then the URL is:<br><br>		<table><tr><td width="24">&nbsp;</td><td><a href="http://127.0.0.1:81/editInPike">http://127.0.0.1:81/editInPike</a><br><br></td></tr></table>	Further, the URL must have information encoded that contains: the server, port, sitename, msgnum, username, password. <br><br>		<table><tr><td width="24">&nbsp;</td><td><a href="http://127.0.0.1:81/editInPike$bull.editthispage.com,80,2087,bull@mancuso.com,yomama">http://127.0.0.1:81/editInPike$bull.editthispage.com,80,2087,bull@mancuso.com,yomama</a><br><br></td></tr></table>	Yes Virgina, your username and password are in the web page. Don't email that page to anyone. ";->"<br><br><b>When the user clicks the button</b><br><br>	When the user clicks on the button the request goes to Pike, not Manila.<br><br>	A new responder is installed in Pike, called editInPike.<br><br>	It calls back to the server sending back the servername, msgnum, and the gobbledy-gook. <br><br>	It responds with a <struct> that's exactly what it would have sent to Pike if it had sent an XML-RPC message in the other direction.<br><br>	Voila. Manila no longer has to send an XML-RPC message to Pike.<br><br><b>After opening the document in Pike</b><br><br>	Pike redirects.. where??<br><br>	How about back to the its referer?<br><br><b>Implementation notes</b><br><br>	Wednesday, May 10, 2000 at 7:50:37 AM by DW<br><br>		<table><tr><td width="24">&nbsp;</td><td>Added a new (temporary) variable, user.prefs.flNewPikeButton, if present and true, mainResponder.discuss.readMessage generates the new style of Pike button. This is intended to make it easy to integrate these features into the update flow, when the time comes for that.<br><br></td></tr></table>	Wednesday, May 10, 2000 at 8:16:53 AM by DW<br><br>		<table><tr><td width="24">&nbsp;</td><td>OK, the server side is done. Next step is to write the responder that runs in Pike. <i>This is fun!</i><br><br></td></tr></table>		<table><tr><td width="24">&nbsp;</td><td>Note: The only code that changed on the server was mainResponder.discuss.readMessage. Instead of grabbing the url from the #urls table, I create it on the fly. To put it in the #urls table implies that it could change on a site by site level. It can't. It must be the same in all Pikes.<br><br></td></tr></table>	Wednesday, May 10, 2000 at 10:07:22 AM by DW<br><br>		<table><tr><td width="24">&nbsp;</td><td>Back at work, doing the responder.<br><br></td></tr></table><p><p>
			<br><br><hr><b>There are responses to this message:</b><ul><li>&nbsp;<a href="msg017163.html">Re: Piking behind firewalls [In Progress]</a>, David Brown, 5/10/2000; 10:59:16 AM<p><li>&nbsp;<a href="msg017167.html">Tough problem to solve...</a>, David Brown, 5/10/2000; 11:59:59 AM<p><li>&nbsp;<a href="msg017171.html">It worked!</a>, Dave Winer, 5/10/2000; 12:34:35 PM<p><li>&nbsp;<a href="msg017187.html">Hash generation location?</a>, William Crim, 5/10/2000; 5:31:13 PM<p><li>&nbsp;<a href="msg017191.html">Firewalls with Piking Sauce (Preview)</a>, Dave Winer, 5/10/2000; 8:28:20 PM<p><li>&nbsp;<a href="msg017380.html">Re: Piking behind firewalls</a>, David Brown, 5/18/2000; 4:59:57 PM<p></ul>			<br><br><hr>This page was archived on 6/13/2001; 4:55:08 PM.<br><br>&copy; Copyright 1998-2001 <a href="http://www.userland.com/">UserLand Software</a>, Inc.			</blockquote></blockquote>		</body>	</html>